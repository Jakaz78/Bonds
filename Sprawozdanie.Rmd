---
title: "Sprawozdanie"
author: "Jakub Kaźmierczyk"
date: "2025-05-29"
output: pdf_document
---

# Wprowadzenie

## Opis projektu

cos tam cos tam

## Zmienna objaśniana

Close - zmienna objasniana bedzie rentownosc 10-letnich polskich obligacji skarbowcyh

## Zmienne objaśniające

XAUUSD - cena złota w dolarze amerykańskim\
S&P500 - ETF 500 największych notowanych na giełdzie amerykańskich spółek\
PMI - cos tam\
WIG20 - 20 najwiekszych notowanych na gieldzie polskich spolek\
OIL - cena ropy naftowej za barylke\
UNEMPLOYMENT - stopa bezrobocia w Polsce\
USDPLN - kurs dolara amerykańskiego wyrażony w złotych\
INFLATION - inflacja r/r wobec miesiąca odpowiadającego z roku temu\

## Źródła

[www.stooq.com](https://stooq.pl)\

```{r setup, include=FALSE}
library(corrplot)
library(readxl)
library(tinytex)
library(ggcorrplot)
library(urca)      
library(tseries)   
library(ggplot2)   
library(dplyr)     
library(tidyr)

```

# Wczytywanie danych

```{r}

data2 <- read_excel("data2.xlsx")

data_numeric <- data2[, c("Close", "Inflation",  "XAUUSD", 
                          "USDPLN",  
                          "WIG20", "S&P500", "UNEMPLOYMENT", "PMI", "OIL")]

Y <- data2["Close"]
X <- data2[,c("Inflation","XAUUSD", "USDPLN","WIG20","S&P500","UNEMPLOYMENT","PMI","OIL")]

data_numeric <- data_numeric[sapply(data_numeric, is.numeric)]
```

# Podstawowe statystyki

## Zmienna objaśniana

```{r}
summary(Y)
```

## Zmienne objaśniające

```{r}
summary(X)

```

# Zaleznosci miedzy Y a X

```{r}

```

# Macierz korelacji

```{r corrplot, fig.width=20, fig.height=20}
cor_matrix <- cor(data_numeric, use = "pairwise.complete.obs", method = "pearson")


    corrplot(cor_matrix, method = "color",
           order = "hclust",
           addCoef.col = "black", 
           tl.col = "black", tl.cex = 2.5, cl.cex = 2.5, number.cex=2.6)
```

## Test

```{r}
# Funkcja do testu ADF
adf_result <- function(series, name) {
  test <- ur.df(series, type = "trend", selectlags = "AIC")
  cat("Test ADF dla zmiennej:", name, "\n")
  print(summary(test))
  cat("\n\n")
}

# Funkcja do testu KPSS
kpss_result <- function(series, name) {
  cat("Test KPSS dla zmiennej:", name, "\n")
  print(kpss.test(series))
  cat("\n\n")
}

# Funkcja do wykresów
plot_series_diff <- function(series, name) {
  df <- data.frame(
    Time = 1:length(series),
    Series = as.numeric(series),
    Diff = c(NA, diff(series))
  )

  p1 <- ggplot(df, aes(x = Time, y = Series)) +
    geom_line(color = "blue") +
    labs(title = paste("Szereg czasowy:", name), y = name)

  p2 <- ggplot(df, aes(x = Time, y = Diff)) +
    geom_line(color = "red") +
    labs(title = paste("Pierwsza różnica:", name), y = paste("Δ", name))

  list(p1, p2)
}
variables <- c("Close", "Inflation", "XAUUSD", "USDPLN", 
               "WIG20", "S&P500", "UNEMPLOYMENT", "PMI", "OIL")

for (var in variables) {
  cat("## Zmienna:", var, "\n\n")
  series <- ts(data2[[var]])

  # Wykresy
  plots <- plot_series_diff(series, var)
  print(plots[[1]])
  print(plots[[2]])

  # Test ADF
  adf_result(series, var)

  # Test KPSS
  kpss_result(series, var)

  cat("\n\n")
}

```
